<!DOCTYPE HTML>
<html lang="zh">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>tatsuno.top/</title>
	<link rel="shortcut icon" href="src/icon.png?ver=6" />
	<link rel="preload" as="font" href="src/Poppins Regular.woff2" crossorigin="anonymous" />
	<script src="https://s3.pstatp.com/cdn/expire-1-M/jquery/3.3.1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/animation.css">
	<link rel="stylesheet" type="text/css" href="css/player.css">

	<!-- Mobile Device -->
	<link rel="stylesheet" type="text/css" media="screen and (max-width: 900px)" href="css/mobile.css" />

	<!-- blog.html -->

</head>



<style>

@font-face{font-family: 'Poppins Regular';src: url('src/Poppins Regular.woff2');}body{font-family: 'Poppins Regular','Microsoft YaHei';overflow: overlay;margin: 0;line-height: 33px;min-width: 380px;}: : -webkit-scrollbar{width: 12px !important;height: 12px !important;background-color: transparent !important;}: : -webkit-scrollbar-track{background-color: transparent !important;box-shadow: none !important;}: : -webkit-scrollbar-thumb{background-color: rgba(0,0,0,0.1) !important;border-radius: 100px !important;border: 4px solid transparent !important;background-clip: content-box !important;box-shadow: none !important;}: : -webkit-scrollbar-thumb: hover{background-color: rgba(0,0,0,0.2) !important;}: : -webkit-scrollbar-corner{background-color: transparent !important;box-shadow: none !important;}: : selection{background: rgba(113,199,173,0.3);}a{text-decoration: none;-webkit-user-drag: none;}img{-webkit-user-select: none;-webkit-user-drag: none;}.blog{position: fixed;z-index: 5;top: 0;left: 0;bottom: 0;width: 100%;background-color: rgba(255,255,255,1);opacity: 1;transition: 0.5s;}.iframe{position: absolute;top: -2px;left: -2px;right: -2px;bottom: -2px;height: 100%;width: 100%;display: none;-webkit-user-select: none;}.body-scroll{overflow: hidden;}.t-9{position: absolute;width: 180px;height: 135px;left: 80px;top: 15px;}.menu-btn-1{position: fixed;color: rgba(100, 102, 102, 0.3);background-color: rgba(255, 255, 255,0.6);top: 15px;left: 15px;width: 35px;height: 25px;border-radius: 100px;padding: 10px 5px;z-index: 20;font-size: 34px;line-height: 33px;cursor: pointer;user-select: none; opacity:0; transition: 0.3s;backdrop-filter: blur(3px);}.menu-btn-1: hover{color: rgba(100, 102, 102, 0.5);}.f-2 {display: unset;}.f-3 {display: none;}.pageloading{position:fixed;height:100px;width:300px;top:calc(50% - 50px);left:calc(50% - 150px);z-index:20;text-align:center;user-select:none;display:none}.pageloading0{font-size:20px;color:rgba(192,194,194,1)}.pageloading1{display:none;font-size:14px;color: rgba(255, 0, 20, 0.8);white-space: nowrap}

</style>



<body style="-ms-overflow-style: none;" id="body" >
	<div class="FixedBox" >

		<!-- Menu  -->
		<div class="menu-btn-1" onclick="env.f.back()" ></div>

	</div>

	<!-- Player   V. 1.19 -->
	<div class="Player" >

		<!-- COVER -->
		<div class="MusicImgBox" onclick="player.f.menu()" >
			<img class="MusicImg" onload="$('.Player').addClass('Player-active')" id="load-img" />
		</div>
		<div class="bar2" ><div class="bar0" ><div class="bar1" ></div></div></div>

		<div class="Player-menu" >
			<span class="list-head" >歌曲列表 <a href="javascript:;" onclick="player.f.reset()" class="resetList" title="重置歌单" ></a></span>
			<a href="javascript:;" onclick="player.f.mode()" id="Mod" title="列表循环" ></a>
			<span href="javascript:;" class="Player-menu-sound0" >0</span>
			<span href="javascript:;" class="Player-menu-sound1" title="使用鼠标滑轮调整音量" ><span href="javascript:;" class="Player-menu-sound2"></span></span>

			<hr class="list-line" />
			<div class="PlayerList" >
				<div class="PlayerListInner" ></div>
			</div>
		</div>
		<div class="Player-menu-info" >
			<div class="Player-menu-info-title" >
				这篇文章自带了 1 首音乐哦，
				<br />
				想要听听吗？
				<br />
				<span style="float: right; user-select: none;" >
					<a class="Player-menu-info-button Player-menu-info-open" >打开</a> | <a class="Player-menu-info-button" onclick="player.f.add.ask(0)" >关闭</a>
				</span>
			</div>
		</div>
		<div class="PlayerButton PlayerButton-pause" onclick="player.f.play()" ></div>
		<div class="MusicName" ></div>
		<audio id="player" src="https://music.163.com/song/media/outer/url?id=448316625.mp3" preload="none" ></audio>
		<a href="javascript:;" onclick="player.f.show()" class="MusicShow0 f-3" ></a>
		<a href="javascript:;" onclick="player.f.show()" class="MusicShow1 f-3" ></a>
	</div>



<!-- Main Code -->
<div class="main">
	<!-- Blog Iframe -->
	<div class="blog" >
		<iframe name="frame" class="iframe" id="iframe" ></iframe>
	</div>
</div>



<!-- Javascript -->

	<script>

const env = {data: {}, f: {}, tmp: {}, timer: {}}
env.timer.t1 = null
env.timer.t2 = null
env.data.list = {}

env.f = {}

// iframe 通讯器
env.f.post = function(event) {
	document.getElementById('iframe').contentWindow.postMessage(event, document.domain.length == 0 && '*' || '/');
}

// 计算网站上线时间
env.f.getDate = function() {
	var seconds = 1000
	var minutes = seconds * 60
	var hours = minutes * 60
	var days = hours * 24
	var years = days * 365
	var today = new Date()
	var todaySecond = today.getSeconds()
	var t1 = Date.UTC(2023,1,3,11,23,35)
	var t2 = Date.UTC(today.getFullYear(), today.getMonth(), today.getDate(), today.getHours(), today.getMinutes(), today.getSeconds())
	var diff = t2-t1
	var diffYears = Math.floor(diff/years)
	var diffDays = Math.floor((diff/days)-diffYears*365)

	return diffYears*365+diffDays
}

env.f.BlogPage = function(url) {
	env.data.change = 1
	document.getElementById('iframe').src = url;
	env.f.page.loading()
}

env.f.page = {}
	// 博客页面加载动画
	env.f.page.loading = function() {
		clearInterval(env.timer.t2)
		$('.pageloading').fadeIn(150)
		$('.pageloading1').css('display', 'none')

		env.timer.t2 = setInterval(() => {
			$('.pageloading1').fadeIn(150)
			clearInterval(env.timer.t2)
		},20000)
	}
		env.f.page.loading.stop = function() {
			clearInterval(env.timer.t2)
			$('.pageloading1').css('display', 'none')
			$('.pageloading').fadeOut(300)
		}

	// 博客页面加载完成后调用
	env.f.page.ok = function(title) {
		if (title.slice(0, 1) == '-') {
			$('title').text('tatsuno.top/ ' + title)
		} else {
			$('title').text(title)
		}

		setTimeout(function (){
			env.f.page.loading.stop()
			$('.iframe').fadeIn(400)
		},1000)
	}

// 设置 Cookie
env.f.setCookie = function(value) {
	var now = new Date();
	var oneWeekLater = new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000); 
	var expires = oneWeekLater.toUTCString();
	document.cookie = "Cookie=" + value + "; expires=" + expires;
	return expires;
}

// 读取 Cookie
env.f.getCookie = function(name) {
	var pattern = new RegExp('(?:^|; )' + name + '=([^;]*)');
	var matches = document.cookie.match(pattern);
	if (matches) {
		return decodeURIComponent(matches[1]);
	}
	return undefined;
}

// 返回主页
env.f.back = function() {
	$('#body').fadeOut(400);
	setTimeout(function (){
		window.location.href = 'index';
	},500)
}

// 读取 url 中的参数
env.f.GetQueryString = function(name) {
	var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
	var r = window.location.search.substr(1).match(reg);
	var context = "";
	if (r != null)
		context = decodeURIComponent(r[2]);
	reg = null;
	r = null;
	return context == null || context == "" || context == "undefined" ? "undefined" : context;
}

env.f.openPage = function() {
	var TargetBlog = env.f.GetQueryString('id')
	var BlogList = env.data.list.Bloglist
	if (TargetBlog!='undefined') {
		if (TargetBlog=='ERROR') {
			env.f.BlogPage('blog/error')
		} else {
			for (var i = 0; i < BlogList.length; i++) {
				if (BlogList[i]['src']==TargetBlog + '/') {
					env.f.BlogPage('blog/' + TargetBlog + '/page' + (document.domain == '' && '.html' || ''))
					break
				} else {
					if (i==BlogList.length-1) {
						env.f.BlogPage('blog/error' + (document.domain == '' && '.html' || ''))
					}
				}
			}
		}
	} else {
		env.f.BlogPage('blog/error' + (document.domain == '' && '.html' || ''))
	}
}


env.data.time = env.f.getDate()
env.data.visitors = 0
env.data.lang = navigator.language
env.data.device = $(window).width() < 900 && 'Mobile' || 'Desktop'
env.data.states = document.domain == '' && 'Local' || 'Network'
env.data.memory = {}
env.data.memory.obj = performance.memory
env.data.memory.check = null
env.data.change = 0





// 设置全局监听器

// 接受博客页面的信号
window.addEventListener('message', function(event) {
	if (event.origin == 'null' || event.origin.includes('https://tatsuno.top')) {
		eval(event.data);
	}
})

// 页面加载完成后执行
window.addEventListener('load',function(){

	// 获取访问量
	if (env.data.states == 'Network') {
		// 一周内的重复访问不计数
		if (env.f.getCookie('Cookie') == undefined) {
			var mode = 1
		} else {
			var mode = 0
		}

		fetch('https://tatsuno.top/counter.api', {
			method: "POST",
			headers: {
				"Token": mode
			}
		})
		.then(response => {return response.json()})
		.then(json => {
			env.data.visitors = parseFloat(json.results[0].content)
			env.f.setCookie('Cookie !')
		})
	}
})

// 检测到后退，前进时，直接关闭博客页面
$('#iframe').on('load', function() {
	if (env.data.change != 1) {
		env.f.back()
		env.data.change = 0
	} else {
		env.data.change = 0
	}
})



// 显示播放器 菜单按钮
setTimeout(function (){
	$('.Player').addClass('Player-active');
	$('.menu-btn-1').addClass('fade-in-1');
},500)

	</script>

	<!-- Blog Data -->
	<script onload="setTimeout(function (){env.f.openPage()},300)" src="blog\staticDB.js"></script>

	<!-- Player -->
	<script src="js\player.js"></script>

</body>


</html>